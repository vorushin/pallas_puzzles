<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 760 300" font-family="monospace" font-size="12">
  <rect width="760" height="300" fill="white"/>

  <!-- Title -->
  <text x="380" y="25" text-anchor="middle" fill="#111827" font-weight="bold" font-size="15">Online Softmax — Single Pass</text>

  <!-- Initial state -->
  <text x="15" y="90" fill="#6b7280" font-size="11">m = -∞</text>
  <text x="15" y="108" fill="#6b7280" font-size="11">ℓ = 0</text>

  <!-- Tile 0 -->
  <rect x="100" y="60" width="120" height="60" rx="6" fill="#dbeafe" stroke="#3b82f6" stroke-width="1.5"/>
  <text x="160" y="85" text-anchor="middle" fill="#1e40af" font-weight="bold">Tile 0</text>
  <text x="160" y="105" text-anchor="middle" fill="#3b82f6" font-size="10">x[0:128]</text>
  <text x="160" y="145" text-anchor="middle" fill="#1e3a5f" font-size="11">m=2.1</text>
  <text x="160" y="163" text-anchor="middle" fill="#1e3a5f" font-size="11">ℓ=47.3</text>

  <!-- Arrow 0→1 -->
  <line x1="225" y1="90" x2="265" y2="90" stroke="#9ca3af" stroke-width="1.5" marker-end="url(#arr)"/>

  <!-- Tile 1 -->
  <rect x="270" y="60" width="120" height="60" rx="6" fill="#dbeafe" stroke="#3b82f6" stroke-width="1.5"/>
  <text x="330" y="85" text-anchor="middle" fill="#1e40af" font-weight="bold">Tile 1</text>
  <text x="330" y="105" text-anchor="middle" fill="#3b82f6" font-size="10">x[128:256]</text>
  <text x="330" y="145" text-anchor="middle" fill="#1e3a5f" font-size="11">m=3.4</text>
  <text x="330" y="163" text-anchor="middle" fill="#1e3a5f" font-size="11">ℓ=89.1</text>

  <!-- Correction star 1 -->
  <text x="330" y="188" text-anchor="middle" fill="#f59e0b" font-size="18">★</text>
  <text x="330" y="205" text-anchor="middle" fill="#d97706" font-size="10" font-weight="bold">correction!</text>
  <text x="330" y="218" text-anchor="middle" fill="#92400e" font-size="9">ℓ *= exp(2.1 - 3.4)</text>

  <!-- Arrow 1→2 -->
  <line x1="395" y1="90" x2="435" y2="90" stroke="#9ca3af" stroke-width="1.5" marker-end="url(#arr)"/>

  <!-- Tile 2 -->
  <rect x="440" y="60" width="120" height="60" rx="6" fill="#dbeafe" stroke="#3b82f6" stroke-width="1.5"/>
  <text x="500" y="85" text-anchor="middle" fill="#1e40af" font-weight="bold">Tile 2</text>
  <text x="500" y="105" text-anchor="middle" fill="#3b82f6" font-size="10">x[256:384]</text>
  <text x="500" y="145" text-anchor="middle" fill="#1e3a5f" font-size="11">m=3.4</text>
  <text x="500" y="163" text-anchor="middle" fill="#1e3a5f" font-size="11">ℓ=134.7</text>
  <text x="500" y="183" text-anchor="middle" fill="#6b7280" font-size="9">(no correction)</text>

  <!-- Arrow 2→3 -->
  <line x1="565" y1="90" x2="605" y2="90" stroke="#9ca3af" stroke-width="1.5" marker-end="url(#arr)"/>

  <!-- Tile 3 -->
  <rect x="610" y="60" width="120" height="60" rx="6" fill="#dbeafe" stroke="#3b82f6" stroke-width="1.5"/>
  <text x="670" y="85" text-anchor="middle" fill="#1e40af" font-weight="bold">Tile 3</text>
  <text x="670" y="105" text-anchor="middle" fill="#3b82f6" font-size="10">x[384:512]</text>
  <text x="670" y="145" text-anchor="middle" fill="#1e3a5f" font-size="11">m=3.7</text>
  <text x="670" y="163" text-anchor="middle" fill="#1e3a5f" font-size="11">ℓ=201.5</text>

  <!-- Correction star 3 -->
  <text x="670" y="188" text-anchor="middle" fill="#f59e0b" font-size="18">★</text>
  <text x="670" y="205" text-anchor="middle" fill="#d97706" font-size="10" font-weight="bold">correction!</text>
  <text x="670" y="218" text-anchor="middle" fill="#92400e" font-size="9">ℓ *= exp(3.4 - 3.7)</text>

  <!-- Final result -->
  <rect x="200" y="250" width="360" height="35" rx="6" fill="#dcfce7" stroke="#22c55e" stroke-width="1.5"/>
  <text x="380" y="273" text-anchor="middle" fill="#166534" font-weight="bold" font-size="12">Final: m = global max, ℓ = Σ exp(xᵢ - m)  ✓ one pass!</text>

  <defs>
    <marker id="arr" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="6" markerHeight="6" orient="auto">
      <path d="M 0 0 L 10 5 L 0 10 z" fill="#9ca3af"/>
    </marker>
  </defs>
</svg>